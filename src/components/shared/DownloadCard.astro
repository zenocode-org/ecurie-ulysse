---
import Button from "./Button.astro";
import CtaButton from "./CtaButton.astro";
import LazyImage from "./LazyImage.astro";
import type { ImageMetadata } from "astro";

export interface Props {
  title: string;
  description?: string;
  image?: ImageMetadata | string;
  file: string;
  icon?: string;
  className?: string;
}

const {
  title,
  description,
  image,
  file,
  icon = "download",
  className = "",
} = Astro.props;
const baseUrl = import.meta.env.BASE_URL;
---

<div
  class={`group relative overflow-hidden rounded-lg border border-box-border bg-box-bg dark:bg-base-dark-800 shadow-lg hover:shadow-xl transition-all duration-300 ${className}`}
>
  {image && (
    <div class="relative h-48 overflow-hidden">
      {typeof image === "string" ? (
        <img
          src={image}
          alt={title}
          class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
          loading="lazy"
        />
      ) : (
        <LazyImage
          src={image}
          alt={title}
          class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
        />
      )}
      <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
    </div>
  )}
  <div class="p-6">
    <div class="flex items-start gap-4">
      {icon && (
        <div class="flex-shrink-0">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-8 h-8 text-primary-500"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"
            />
          </svg>
        </div>
      )}
      <div class="flex-1">
        <h3 class="text-xl font-semibold mb-2 text-accent dark:text-accent-light">
          {title}
        </h3>
        {description && (
          <p class="text-accent-600 dark:text-accent-300 mb-4">{description}</p>
        )}
        <a href={`${baseUrl}/${file}`} download target="_blank" rel="noopener noreferrer">
          <CtaButton className="w-full sm:w-auto">
            Télécharger
          </CtaButton>
        </a>
      </div>
    </div>
  </div>
</div>


