---
import cavasoftImage from "../../images/commun/cavasoft_light.png";

export interface Props {
  href?: string;
  tooltipText?: string;
}

const { href = "https://lesecuriesdulysse.cavasoft.fr/connexion", tooltipText = "Accéder à votre espace Cavasoft" } = Astro.props;
---

<div class="fixed bottom-6 right-6 z-50">
  <a
    href={href}
    id="cavasoft-button"
    class="block rounded-full shadow-lg hover:shadow-xl transition-shadow duration-300"
    aria-label="Cavasoft"
  >
    <img
      src={cavasoftImage.src}
      alt="Cavasoft"
      class="w-16 h-16 rounded-full object-cover"
    />
  </a>
  <div
    id="cavasoft-tooltip"
    class="absolute bottom-full right-0 mb-3 px-4 py-2 bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 text-sm rounded-lg shadow-lg opacity-0 pointer-events-none transition-opacity duration-300 whitespace-nowrap"
    role="tooltip"
  >
    {tooltipText}
    <div class="absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900 dark:border-t-gray-100"></div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const tooltip = document.getElementById('cavasoft-tooltip');
    if (!tooltip) return;

    // Show tooltip on page load
    setTimeout(() => {
      tooltip.classList.remove('opacity-0', 'pointer-events-none');
      tooltip.classList.add('opacity-100');
    }, 100);

    // Hide tooltip after 30 seconds
    setTimeout(() => {
      tooltip.classList.remove('opacity-100');
      tooltip.classList.add('opacity-0', 'pointer-events-none');
    }, 15000); // 15 seconds + 100ms initial delay
  });
</script>
